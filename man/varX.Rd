% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/varX.R
\name{varX}
\alias{varX}
\alias{sdX}
\alias{varX.default}
\alias{varS.Freq}
\alias{varX.Freq}
\title{(Weighted) Variance and Standard Deviation}
\usage{
sdX(x, estimator = c("unbiased", "ML"), weights = NULL, na.rm = FALSE, ...)

varX(x, ...)

\method{varX}{default}(x, estimator = c("unbiased", "ML"), weights = NULL, na.rm = FALSE, ...)

\method{varX}{Freq}(x, breaks, ...)
}
\arguments{
\item{x}{a numeric vector, matrix or data frame.}

\item{estimator}{determines the estimator type; if \code{"unbiased"} (the
default) then the usual unbiased estimate (using \eqn{n - 1} as denominator)
is returned, if \code{"ML"} then it is the maximum likelihood estimate for a
Gaussian distribution (denominator \eqn{n}). Internally \code{\link{cov.wt}}
is used for both methods.}

\item{weights}{non-negative numeric vector of weights the same length as
\code{x} nterpreted as frequency (replication) weights. Observations with
larger weights contribute more strongly to the empirical distribution.}

\item{na.rm}{logical. Should missing values be removed?}

\item{\dots}{further arguments passed to or from other methods.}

\item{breaks}{breaks for calculating the variance for classified data as
composed by \code{\link{Freq}}.}
}
\value{
single numeric value
}
\description{
\code{varX()} computes the variance of \code{x}, allowing the definition of
weights (unlike base R's \code{\link{var}()} function). Using the estimator
\code{ML} returns the uncorrected sample variance (which is a biased
estimator for the sample variance). \cr\code{sdX} yields the standard
deviation following the same logic.
}
\details{
Using estimator \code{"unbiased"} the denominator \eqn{n - 1} is used (known
as "Bessel's correction") which gives an unbiased estimator of the
(co)variance for i.i.d. observations.\cr \code{"ML"} yields the biased
version using the denominator \eqn{n}.

These functions return \code{\link{NA}} when there is only one observation,
and fail if \code{x} has length zero.

\bold{Note:}\verb{ } Analytic (precision) weights are not supported. For
likelihood-based weighted variance estimation, see
\code{\link[stats]{cov.wt}}.
}
\examples{

varX(1:10)                 # 9.166667
sdX(1:10)

varX(1:5, weights=1:5)     # 2.5
# same as c(1 2 2 3 3 3 4 4 4 4 5 5 5 5 5):
varX(rep(1:5, times=1:5))  # 2.5

# weighted Variance
set.seed(45)
(z <- as.numeric(names(w <- table(x <- sample(-10:20, size=50, replace=TRUE)))))
varX(z, weights=w)
sdX(z, weights=w)

# check!
all.equal(varX(x), varX(z, weights=w))


# Variance for frequency tables
varX(Freq(as.table(c(6,16,24,25,17))),
          breaks=c(0, 10, 20, 30, 40, 50))
     
}
\references{
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988) \emph{The
New S Language}.  Wadsworth & Brooks/Cole.
}
\seealso{
\code{\link{varCI}} for confidence intervals and
\code{\link{varTest}} for tests.

base R's implementations \code{\link{var}}, \code{\link{sd}},
\code{\link{cov}}

also consider \code{\link{madX}}, the most robust alternative
}
\keyword{array}
\keyword{multivariate}
\keyword{univar}
