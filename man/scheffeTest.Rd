% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scheffeTest.R
\name{scheffeTest}
\alias{scheffeTest}
\alias{scheffeTest.default}
\alias{scheffeTest.aov}
\alias{scheffeTest.formula}
\title{Scheffe Test for Pairwise and Otherwise Comparisons}
\usage{
scheffeTest(x, ...)

\method{scheffeTest}{default}(
  x,
  g = NULL,
  which = NULL,
  contrasts = NULL,
  conf.level = 0.95,
  ...
)

\method{scheffeTest}{formula}(formula, data, subset, na.action, ...)

\method{scheffeTest}{aov}(x, which = NULL, contrasts = NULL, conf.level = 0.95, ...)
}
\arguments{
\item{x}{either a fitted model object, usually an \code{\link{aov}} fit,
when g is left to \code{NULL} or a response variable to be evalutated by g
(which mustn't be \code{NULL} then).}

\item{\dots}{further arguments, currently not used.}

\item{g}{the grouping variable.}

\item{which}{character vector listing terms in the fitted model for which
the intervals should be calculated. Defaults to all the terms.}

\item{contrasts}{a \eqn{r \times c}{r x c} matrix containing the contrasts
to be computed, while \code{r} is the number of factor levels and \code{c}
the number of contrasts. Each column must contain a full contrast ("sum")
adding up to 0. Note that the argument \code{which} must be defined, when
non default contrasts are used.  Default value of \code{contrasts} is
\code{NULL}. In this case all pairwise contrasts will be reported.}

\item{conf.level}{numeric value between zero and one giving the confidence
level to use.  If this is set to NA, just a matrix with the p-values will be
returned.}

\item{formula}{A formula of the form \code{lhs ~ rhs}, where \code{lhs}
gives the response values and \code{rhs} the corresponding groups
or explanatory variables.}

\item{data}{An optional matrix or data frame (or similar; see
\code{\link[stats]{model.frame}}) containing the variables in the
formula. By default the variables are taken from
\code{environment(formula)}.}

\item{subset}{An optional vector specifying a subset of observations
to be used in the analysis.}

\item{na.action}{A function which indicates what should happen when
the data contain \code{NA}s. Defaults to
\code{getOption("na.action")}.}
}
\value{
A list of classes \code{c("PostHocTest")}, with one component for
each term requested in \code{which}. Each component is a matrix with columns
\code{diff} giving the difference in the observed means, \code{lwr.ci}
giving the lower end point of the interval, \code{upr.ci} giving the upper
end point and \code{pval} giving the p-value after adjustment for the
multiple comparisons.

There are print and plot methods for class \code{"PostHocTest"}. The plot
method does not accept \code{xlab}, \code{ylab} or \code{main} arguments and
creates its own values for each plot.
}
\description{
Scheffe's method applies to the set of estimates of all possible contrasts
among the factor level means, not just the pairwise differences considered
by Tukey's method.
}
\examples{

fm1 <- aov(breaks ~ wool + tension, data = warpbreaks)
scheffeTest(x=fm1)
scheffeTest(x=fm1, which="tension")

# some special contrasts
y <- c(7,33,26,27,21,6,14,19,6,11,11,18,14,18,19,14,9,12,6,
       24,7,10,1,10,42,25,8,28,30,22,17,32,28,6,1,15,9,15,
       2,37,13,18,23,1,3,4,6,2)
group <- factor(c(1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,3,3,3,3,3,
       3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6))

r.aov <- aov(y ~ group)
scheffeTest(r.aov, contrasts=matrix( c(1,-0.5,-0.5,0,0,0,
                                       0,0,0,1,-0.5,-0.5), ncol=2) )

# just p-values:
scheffeTest(r.aov, conf.level=NA)

}
\references{
Robert O. Kuehl, Steel R. (2000) \emph{Design of experiments}.
Duxbury

Steel R.G.D., Torrie J.H., Dickey, D.A. (1997) \emph{Principles and
Procedures of Statistics, A Biometrical Approach}. McGraw-Hill
}
\seealso{
\code{\link{pairwise.t.test}}, \code{\link{TukeyHSD}}
}
\author{
Andri Signorell \href{mailto:andri@signorell.net}{andri@signorell.net}
}
\keyword{htest}
